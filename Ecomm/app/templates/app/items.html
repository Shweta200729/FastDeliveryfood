{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Restaurant Menu</title>

  <!-- âœ… Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #FFF8F0;
      color: #2C2C2C;
    }

    .scrolled {
      background: rgba(255, 255, 255, 0.95) !important;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body class="overflow-x-hidden">

<div id="navbar"
  class="fixed top-0 left-0 w-full flex justify-between items-center px-10 py-3 bg-white/70 backdrop-blur-md transition-all duration-300 z-50">

  <div class="flex gap-8 items-center font-medium text-[#2C2C2C]">
    <div class="hover:text-[#F4A460] cursor-pointer">ğŸ½ï¸ Menu</div>
    <div class="hover:text-[#F4A460] cursor-pointer">ğŸ“… Book Table</div>
    <div class="hover:text-[#F4A460] cursor-pointer">ğŸ‰ Offers</div>
    <div class="hover:text-[#F4A460] cursor-pointer">ğŸ“ Contact</div>
  </div>

  <!-- Cart Button Form -->
  <form method="post" action="">
    {% csrf_token %}
    <button type="submit" name="btn_type" value="cart"
      class="flex items-center gap-2 bg-[#F4A460] text-white px-4 py-2 rounded-full font-semibold hover:scale-105 hover:shadow-lg transition-all duration-300 cursor-pointer">
      <span>ğŸ›’</span>
      <span id="cartCount">0</span>
    </button>
  </form>
</div>


  <div class="mt-20 px-10 text-center">
    <input
      id="searchInput"
      type="text"
      placeholder="Search dishes..."
      class="w-full max-w-md border-2 border-gray-200 rounded-full px-5 py-3 focus:outline-none focus:border-[#F4A460] focus:shadow-lg transition-all duration-300"
    />
  </div>

  <div class="flex justify-center flex-wrap gap-4 px-10 py-4">
    <button class="category-btn active bg-[#F4A460] text-white border-2 border-[#F4A460] px-6 py-2 rounded-full font-semibold transition-all duration-300" onclick="showCategory('All', event)">All</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Starters', event)">Starters</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Main Course', event)">Main Course</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Beverages', event)">Beverages</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Desserts', event)">Desserts</button>
  </div>

  <!-- Cards -->
  <div id="cardContainer" class="fix grid grid-cols-[repeat(auto-fill,minmax(220px,1fr))] gap-6 px-10 pb-10 max-w-[1400px] mx-auto"></div>




    <script>
  let dishes = {};

  fetch('/RenderItem/')
    .then(response => response.json())
    .then(data => {
      dishes = data; // Save the fetched menu
      console.log('âœ… Menu data loaded:', dishes);
      showCategory('All', { target: document.querySelector('.category-btn') });
    })
    .catch(error => {
      console.error('âŒ Error fetching menu data:', error);
      const container = document.getElementById('cardContainer');
      container.innerHTML = `<p class="text-center text-red-500 mt-10">Failed to load menu data.</p>`;
    });

  function showCategory(category, event) {
    const container = document.getElementById('cardContainer');
    container.innerHTML = '';

    if (!dishes || Object.keys(dishes).length === 0) {
      container.innerHTML = `<p class="text-center text-gray-500 mt-10">Loading menu...</p>`;
      return;
    }

    const items =
      category === 'All'
        ? Object.values(dishes).flat()
        : (dishes[category] || []);

    items.forEach(dish => {
      const card = document.createElement('div');
      card.className =
        "bg-white rounded-xl overflow-hidden shadow-md hover:-translate-y-2 hover:shadow-2xl transition-all duration-300 cursor-pointer";
      card.innerHTML = `
        <img src="${dish.img}" alt="${dish.name}" class="w-full h-40 object-cover">
        <div class="p-4">
          <h4 class="text-lg font-semibold mb-1">${dish.name}</h4>
          <p class="text-sm text-gray-600 mb-3">${dish.desc}</p>
          <div class="flex justify-between items-center">
            <span class="text-[#F4A460] font-bold text-lg">â‚¹${dish.price}</span>
            <button onclick="addToCart(event,'${dish.name}','${dish.desc}','${dish.img}','${dish.price}')" class="bg-[#F4A460] text-white px-4 py-2 rounded-full font-semibold hover:scale-105 transition-all duration-300">Add</button>
          </div>
        </div>
      `;
      container.appendChild(card);
    });

    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.classList.remove('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
      btn.classList.add('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
    });

    if (event?.target) {
      const activeBtn = event.target;
      activeBtn.classList.remove('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
      activeBtn.classList.add('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
    }
  }

  async function addToCart(event, prd_name , desc, img_src, price) {

    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split(";");
        for (let cookie of cookies) {
          cookie = cookie.trim();
          if (cookie.startsWith(name + "=")) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }

    const btn = event.target;
    data = {
      'prd_name' : prd_name,
      'desc' : desc,
      'img_src' : img_src,
      'price' : price,
    }
    btn.textContent = 'âœ“ Added';
    setTimeout(() => (btn.textContent = 'Add'), 1500);
    const response = await fetch('/send_cart_data/',{
      method: 'POST',
      headers: {
          "Content-Type": "application/json",
          "X-CSRFToken": getCookie("csrftoken")  
        },
      body : JSON.stringify(data)
    })
    
    const result = await response.json()
  }

  window.addEventListener('scroll', () => {
    const navbar = document.getElementById('navbar');
    navbar.classList.toggle('scrolled', window.scrollY > 50);
  });

  document.getElementById('cardContainer').innerHTML =
    `<p class="text-center text-gray-500 mt-10">Loading menu...</p>`;



/*
    fetch('/RenderItem/')
    .then(response => response.json())
    .then(data => {
      let dishes = {
      'Starters': [
        { name: 'Spring Rolls', desc: 'Crispy veggie rolls', price: 'â‚¹99', img: "{% static 'src/assets/crepe-with-cheese-vegetables-plate.jpg' %}" },
        { name: 'Garlic Bread', desc: 'Toasted with herbs', price: 'â‚¹79', img: "{% static 'src/assets/sandevil-sandh-BRMvT4sw-4c-unsplash.jpg' %}" }
      ],
      'Main Course': [
        { name: 'Paneer Butter Masala', desc: 'Rich tomato gravy', price: 'â‚¹199', img: "{% static 'src/assets/delicious-food-table.jpg' %}" },
        { name: 'Veg Biryani', desc: 'Spiced rice dish', price: 'â‚¹179', img: "{% static 'src/assets/high-angle-pakistan-meal-composition.jpg' %}" }
      ],
      'Beverages': [
        { name: 'Lemonade', desc: 'Fresh and tangy', price: 'â‚¹49', img: "{% static 'src/assets/wesley-shen-Ded3lxHBLFw-unsplash.jpg' %}" },
        { name: 'Cold Coffee', desc: 'Chilled and creamy', price: 'â‚¹89', img: "{% static 'src/assets/eiliv-aceron-44d0W8JhoPc-unsplash.jpg' %}" }
      ],
      'Desserts': [
        { name: 'Gulab Jamun', desc: 'Sweet syrup balls', price: 'â‚¹59', img: "{% static 'src/assets/high-angle-delicious-indian-dessert.jpg' %}" },
        { name: 'Ice Cream', desc: 'Vanilla scoop', price: 'â‚¹69', img: "{% static 'src/assets/delicious-ice-cream-with-topping.jpg' %}" }
      ] 
    };


    dishes = data;

    })

    function showCategory(category, event) {
      const container = document.getElementById('cardContainer');
      container.innerHTML = '';
      const items = category === 'All' ? Object.values(dishes).flat() : dishes[category];

      items.forEach(dish => {
        const card = document.createElement('div');
        card.className = "bg-white rounded-xl overflow-hidden shadow-md hover:-translate-y-2 hover:shadow-2xl transition-all duration-300 cursor-pointer";
        card.innerHTML = `
          <img src="${dish.img}" alt="${dish.name}" class="w-full h-40 object-cover">
          <div class="p-4">
            <h4 class="text-lg font-semibold mb-1">${dish.name}</h4>
            <p class="text-sm text-gray-600 mb-3">${dish.desc}</p>
            <div class="flex justify-between items-center">
              <span class="text-[#F4A460] font-bold text-lg">${dish.price}</span>
              <button onclick="addToCart(event)" class="bg-[#F4A460] text-white px-4 py-2 rounded-full font-semibold hover:scale-105 transition-all duration-300">Add</button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });

      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
        btn.classList.add('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
      });

      const activeBtn = event.target;
      activeBtn.classList.remove('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
      activeBtn.classList.add('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
    }

    function addToCart(event) {
      const btn = event.target;
      btn.textContent = 'âœ“ Added';
      setTimeout(() => btn.textContent = 'Add', 1500);
    }

    window.addEventListener('scroll', () => {
      const navbar = document.getElementById('navbar');
      navbar.classList.toggle('scrolled', window.scrollY > 50);
    });

    showCategory('All', { target: document.querySelector('.category-btn') });

    */
  </script>
</body>
</html>
