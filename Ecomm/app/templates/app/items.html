{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Restaurant Menu</title>

  <!-- ✅ Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- GSAP for scroll animations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #FFF8F0;
      color: #2C2C2C;
    }

    .scrolled {
      background: rgba(255, 255, 255, 0.95) !important;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body class="overflow-x-hidden">

  <!-- Navbar -->
  <div id="navbar" class="fixed top-0 left-0 w-full flex justify-between items-center px-10 py-3 bg-white/70 backdrop-blur-md transition-all duration-300 z-50">
    <div class="flex gap-8 items-center font-medium text-[#2C2C2C]">
      <div class="hover:text-[#F4A460] cursor-pointer">🍽️ Menu</div>
      <div class="hover:text-[#F4A460] cursor-pointer">📅 Book Table</div>
      <div class="hover:text-[#F4A460] cursor-pointer">🎉 Offers</div>
      <div class="hover:text-[#F4A460] cursor-pointer">📞 Contact</div>
    </div>

  <form method="post">
      {% csrf_token %}
      <button type='submit' name='btn_type' value ='cart'>
        <div id="cartIcon" class="flex items-center gap-2 bg-[#F4A460] text-white px-4 py-2 rounded-full font-semibold hover:scale-105 hover:shadow-lg transition-all duration-300 cursor-pointer">
      <span>🛒</span>
      <span id="cartCount">0</span>
    </div>
      </button>
      
  </div>
    </form>
    

  <!-- Search -->
  <div class="mt-20 px-10 text-center">
    <input
      id="searchInput"
      type="text"
      placeholder="Search dishes..."
      class="w-full max-w-md border-2 border-gray-200 rounded-full px-5 py-3 focus:outline-none focus:border-[#F4A460] focus:shadow-lg transition-all duration-300"
    />
  </div>

  <!-- Categories -->
  <div class="flex justify-center flex-wrap gap-4 px-10 py-4">
    <button class="category-btn active bg-[#F4A460] text-white border-2 border-[#F4A460] px-6 py-2 rounded-full font-semibold transition-all duration-300" onclick="showCategory('All', event)">All</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Starters', event)">Starters</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Main Course', event)">Main Course</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Beverages', event)">Beverages</button>
    <button class="category-btn border-2 border-gray-200 bg-white text-[#2C2C2C] px-6 py-2 rounded-full font-semibold hover:bg-[#F4A460] hover:text-white transition-all duration-300" onclick="showCategory('Desserts', event)">Desserts</button>
  </div>

  <!-- Cards -->
  <div id="cardContainer" class="grid grid-cols-[repeat(auto-fill,minmax(220px,1fr))] gap-6 px-10 pb-10 max-w-[1400px] mx-auto"></div>




    <script>
  // 🌍 Global variable to store dishes fetched from Django
  let dishes = {};

  // 🍴 Fetch menu data from your Django view
  fetch('/RenderItem/')
    .then(response => response.json())
    .then(data => {
      dishes = data; // Save the fetched menu
      console.log('✅ Menu data loaded:', dishes);

      // Show all dishes once data is loaded
      showCategory('All', { target: document.querySelector('.category-btn') });
    })
    .catch(error => {
      console.error('❌ Error fetching menu data:', error);
      const container = document.getElementById('cardContainer');
      container.innerHTML = `<p class="text-center text-red-500 mt-10">Failed to load menu data.</p>`;
    });

  // 🍽️ Function to display dishes by category
  function showCategory(category, event) {
    const container = document.getElementById('cardContainer');
    container.innerHTML = '';

    // ⏳ Show loader if data not yet ready
    if (!dishes || Object.keys(dishes).length === 0) {
      container.innerHTML = `<p class="text-center text-gray-500 mt-10">Loading menu...</p>`;
      return;
    }

    // 📋 Get all dishes or a specific category
    const items =
      category === 'All'
        ? Object.values(dishes).flat()
        : (dishes[category] || []);

    // 🃏 Generate cards dynamically
    items.forEach(dish => {
      const card = document.createElement('div');
      card.className =
        "bg-white rounded-xl overflow-hidden shadow-md hover:-translate-y-2 hover:shadow-2xl transition-all duration-300 cursor-pointer";
      card.innerHTML = `
        <img src="${dish.img}" alt="${dish.name}" class="w-full h-40 object-cover">
        <div class="p-4">
          <h4 class="text-lg font-semibold mb-1">${dish.name}</h4>
          <p class="text-sm text-gray-600 mb-3">${dish.desc}</p>
          <div class="flex justify-between items-center">
            <span class="text-[#F4A460] font-bold text-lg">₹${dish.price}</span>
            <button onclick="addToCart(event)" class="bg-[#F4A460] text-white px-4 py-2 rounded-full font-semibold hover:scale-105 transition-all duration-300">Add</button>
          </div>
        </div>
      `;
      container.appendChild(card);
    });

    // 🟡 Update category button styles
    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.classList.remove('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
      btn.classList.add('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
    });

    if (event?.target) {
      const activeBtn = event.target;
      activeBtn.classList.remove('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
      activeBtn.classList.add('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
    }
  }

  // 🛒 Simple add-to-cart animation
  function addToCart(event) {
    const btn = event.target;
    btn.textContent = '✓ Added';
    setTimeout(() => (btn.textContent = 'Add'), 1500);
  }

  // 🌫️ Sticky navbar shadow on scroll
  window.addEventListener('scroll', () => {
    const navbar = document.getElementById('navbar');
    navbar.classList.toggle('scrolled', window.scrollY > 50);
  });

  // 🚀 Optionally show "Loading" initially before fetch completes
  document.getElementById('cardContainer').innerHTML =
    `<p class="text-center text-gray-500 mt-10">Loading menu...</p>`;






/*
    fetch('/RenderItem/')
    .then(response => response.json())
    .then(data => {
      let dishes = {
      {% comment %} 'Starters': [
        { name: 'Spring Rolls', desc: 'Crispy veggie rolls', price: '₹99', img: "{% static 'src/assets/crepe-with-cheese-vegetables-plate.jpg' %}" },
        { name: 'Garlic Bread', desc: 'Toasted with herbs', price: '₹79', img: "{% static 'src/assets/sandevil-sandh-BRMvT4sw-4c-unsplash.jpg' %}" }
      ],
      'Main Course': [
        { name: 'Paneer Butter Masala', desc: 'Rich tomato gravy', price: '₹199', img: "{% static 'src/assets/delicious-food-table.jpg' %}" },
        { name: 'Veg Biryani', desc: 'Spiced rice dish', price: '₹179', img: "{% static 'src/assets/high-angle-pakistan-meal-composition.jpg' %}" }
      ],
      'Beverages': [
        { name: 'Lemonade', desc: 'Fresh and tangy', price: '₹49', img: "{% static 'src/assets/wesley-shen-Ded3lxHBLFw-unsplash.jpg' %}" },
        { name: 'Cold Coffee', desc: 'Chilled and creamy', price: '₹89', img: "{% static 'src/assets/eiliv-aceron-44d0W8JhoPc-unsplash.jpg' %}" }
      ],
      'Desserts': [
        { name: 'Gulab Jamun', desc: 'Sweet syrup balls', price: '₹59', img: "{% static 'src/assets/high-angle-delicious-indian-dessert.jpg' %}" },
        { name: 'Ice Cream', desc: 'Vanilla scoop', price: '₹69', img: "{% static 'src/assets/delicious-ice-cream-with-topping.jpg' %}" }
      ] {% endcomment %}
    };


    dishes = data;

    })

    function showCategory(category, event) {
      const container = document.getElementById('cardContainer');
      container.innerHTML = '';
      const items = category === 'All' ? Object.values(dishes).flat() : dishes[category];

      items.forEach(dish => {
        const card = document.createElement('div');
        card.className = "bg-white rounded-xl overflow-hidden shadow-md hover:-translate-y-2 hover:shadow-2xl transition-all duration-300 cursor-pointer";
        card.innerHTML = `
          <img src="${dish.img}" alt="${dish.name}" class="w-full h-40 object-cover">
          <div class="p-4">
            <h4 class="text-lg font-semibold mb-1">${dish.name}</h4>
            <p class="text-sm text-gray-600 mb-3">${dish.desc}</p>
            <div class="flex justify-between items-center">
              <span class="text-[#F4A460] font-bold text-lg">${dish.price}</span>
              <button onclick="addToCart(event)" class="bg-[#F4A460] text-white px-4 py-2 rounded-full font-semibold hover:scale-105 transition-all duration-300">Add</button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });

      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
        btn.classList.add('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
      });

      const activeBtn = event.target;
      activeBtn.classList.remove('bg-white', 'text-[#2C2C2C]', 'border-gray-200');
      activeBtn.classList.add('bg-[#F4A460]', 'text-white', 'border-[#F4A460]');
    }

    function addToCart(event) {
      const btn = event.target;
      btn.textContent = '✓ Added';
      setTimeout(() => btn.textContent = 'Add', 1500);
    }

    window.addEventListener('scroll', () => {
      const navbar = document.getElementById('navbar');
      navbar.classList.toggle('scrolled', window.scrollY > 50);
    });

    showCategory('All', { target: document.querySelector('.category-btn') });

    */
  </script>
</body>
</html>
